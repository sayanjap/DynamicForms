{% extends 'examples/base.html' %}
{% block head_extra %}
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/axios@0.16.2/dist/axios.min.js" crossorigin="anonymous"></script>
{% endblock %}
{% block title %}Render in template example{% endblock %}
{% block body %}

  <div id="app">
    {{ page_data }}
  </div>

  <script>
    Vue.component('df-table', {
      props: ['url', 'initialData'],
      data() {
        const self = this;
        return {rows: self.initialRows};
      },
      computed: {
        initialRows: function () {
          const self = this;
          if (self.initialData == undefined || self.initialData.constructor != Array) {
            return [];
          }
          return self.initialData;
        }
      },
      mounted() {
        const self = this;
        self.loading = true;
        axios.get(this.url).then(function (res) {
          // call api and set data as response, when data is set component is re-rendered
          self.rows = res.data;
        }).catch(function (err) {
          alert(err.data)
        }).then(function () {
          self.loading = false;
        });
      },
      methods: {},
    });
    Vue.component('df-table-header', {
      props: ['columns'],
      data() {
        // const self = this;
        return {};
      },
      mounted() {
      },
      methods: {}
    });
    Vue.component('df-table-header-col', {
      props: ['column'],
      data() {
        const self = this;
        return self.column;  // {name:str, label:str, align:str, sorted:[int, bool]}
      },
      mounted() {
      },
      methods: {}
    });

    // create vue app with app dic container
    const tableApp = new Vue({
      el: `#app`,
    });
  </script>

{% endblock %}